<!DOCTYPE html>
<html>
<body>

<h2>Dashboard Pavio</h2>
<button onclick="logout()">Logout</button>
<p id="status"></p>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
const supabaseClient = supabase.createClient(
  "https://dxyjtkmtpkqbuotovmyg.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR4eWp0a210cGtxYnVvdG92bXlnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc2NDYwNzgsImV4cCI6MjA4MzIyMjA3OH0.-b50kwMiNs9oy3flr0yUJaEVnVIFQBGnc_rDlKGqOiA"
);

async function check(){
 const { data: { session } } = await supabaseClient.auth.getSession();
 if(!session){
    location.href="login.html";
    return;
 }

 const { data } = await supabaseClient.from("subscriptions").select("*").single();

 if(data && data.active){
   status.innerText="Subscription ACTIVE sampai: "+data.expired_at;
 }else{
   status.innerHTML=`Belum berlangganan<br><a href="#">Berlangganan Sekarang</a>`;
 }
}
check();

function logout(){
 supabaseClient.auth.signOut();
 location.href="login.html";
}
</script>

</body>
</html>
