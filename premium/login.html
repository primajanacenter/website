<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Masuk Pavio</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
*{box-sizing:border-box;}
body{
 background:linear-gradient(135deg,#f5f7fb,#eef2ff);
 font-family:system-ui,-apple-system,BlinkMacSystemFont;
 display:flex;align-items:center;justify-content:center;height:100vh;margin:0;
}
.card{
 background:#fff;max-width:380px;width:100%;
 padding:36px;border-radius:18px;
 box-shadow:0 12px 35px rgba(0,0,0,.08);
}
h2{text-align:center;color:#0d6efd;margin-bottom:25px;}
.input-group{position:relative;margin-bottom:16px;}
input{
 width:100%;
 padding:12px 42px 12px 12px;
 border:1px solid #ddd;border-radius:10px;font-size:14px;
}
.eye{
 position:absolute;right:12px;top:50%;transform:translateY(-50%);
 cursor:pointer;color:#888;
}
button{
 width:100%;padding:12px;border:none;border-radius:10px;
 background:#0d6efd;color:#fff;font-weight:600;cursor:pointer;
}
.secondary{background:#e9f1ff;color:#0d6efd;margin-top:10px;}
#msg{text-align:center;margin-top:12px;font-size:14px;color:#dc3545;}
</style>
</head>
<body>

<div class="card">
<h2>Pavio</h2>

<div class="input-group">
 <input id="email" placeholder="Email">
</div>

<div class="input-group">
 <input id="password" type="password" placeholder="Password">
 <i class="fa fa-eye eye" onclick="togglePwd()"></i>
</div>

<button onclick="doLogin()">Masuk</button>
<button class="secondary" onclick="doRegister()">Daftar Akun</button>
<p id="msg"></p>
</div>

<script type="module">
import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

const supabaseClient = createClient(
 "https://dxyjtkmtpkqbuotovmyg.supabase.co",
 "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR4eWp0a210cGtxYnVvdG92bXlnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc2NDYwNzgsImV4cCI6MjA4MzIyMjA3OH0.-b50kwMiNs9oy3flr0yUJaEVnVIFQBGnc_rDlKGqOiA"
);

window.togglePwd = function(){
 password.type = password.type==="password"?"text":"password";
}

window.doLogin = async function(){
 const { error } = await supabaseClient.auth.signInWithPassword({
   email: email.value,
   password: password.value
 });
 if(error) msg.innerText = error.message;
 else location.href = "dashboard.html";
}

window.doRegister = async function(){
 const { data, error } = await supabaseClient.auth.signUp({
   email: email.value,
   password: password.value
 });
 if(error) msg.innerText = error.message;
 else{
  await supabaseClient.from("subscriptions").insert([{ id: data.user.id }]);
  msg.style.color="#198754";
  msg.innerText="Akun berhasil dibuat. Silakan login.";
 }
}
</script>
</body>
</html>
